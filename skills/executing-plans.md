# 執行計畫技能（Executing Plans）

> **技能 ID**: `executing-plans`
> **版本**: 1.0.0
> **用途**: 批次執行計畫、人工檢查點、驗證驅動開發
> **參考**: [obra/superpowers](https://github.com/obra/superpowers)

---

## 觸發條件

當以下情況發生時，應激活此技能：

- 有完整的實作計畫（由 writing-plans 生成）
- 需要系統化執行多個任務
- 需要定期人工審查進度
- 複雜功能開發需要分批進行

---

## 一、核心原則

```
╔════════════════════════════════════════════════════════════╗
║     批次執行 + 檢查點 = 可控的進度 + 即時反饋              ║
║  Batch execution with checkpoints for architect review     ║
╚════════════════════════════════════════════════════════════╝
```

---

## 二、執行流程

### 2.1 五步流程圖

```
┌─────────────────────────────────────────────────────────────┐
│                    執行計畫流程                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Step 1: 載入與審查                                         │
│          └─ 檢視計畫，識別問題                              │
│                    ↓                                        │
│  Step 2: 執行批次（3 個任務/批次）                          │
│          └─ 逐一完成，驗證每個任務                          │
│                    ↓                                        │
│  Step 3: 報告進度                                           │
│          └─ 展示成果，等待反饋                              │
│                    ↓                                        │
│  Step 4: 整合反饋                                           │
│          └─ 調整方向，繼續下一批次                          │
│                    ↓                                        │
│  Step 5: 完成開發                                           │
│          └─ 調用 git-workflow 完成分支                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 三、詳細步驟

### Step 1: 載入與審查

```markdown
在開始執行之前：

1. **閱讀完整計畫**
   - 理解目標和架構
   - 確認任務清單

2. **識別潛在問題**
   - 依賴關係是否清楚？
   - 驗證步驟是否完整？
   - 是否有技術風險？

3. **提出疑問**
   - 在開始前與用戶確認
   - 不要帶著假設開始
```

**輸出格式**:
```markdown
## 📋 計畫審查

### 計畫概述
- 目標: [一句話描述]
- 任務數: [N] 個
- 預估批次: [N/3] 批

### 確認事項
1. [需要確認的問題 1]
2. [需要確認的問題 2]

### 風險識別
- [潛在風險 1]
- [潛在風險 2]

確認後開始執行？
```

---

### Step 2: 執行批次

**批次大小**: 預設 3 個任務/批次

```markdown
對於每個任務：

1. **標記為進行中**
   使用 TodoWrite 更新狀態

2. **精確執行步驟**
   按照計畫中的步驟執行
   不要偏離或"改進"

3. **執行驗證**
   運行計畫中指定的驗證命令
   確認預期輸出

4. **標記完成**
   更新 TodoWrite 狀態
   記錄驗證結果
```

**任務執行模板**:
```markdown
### 任務 N: [任務名稱]

**狀態**: 🔄 進行中

**執行步驟**:
1. ✅ [步驟 1] - 完成
2. ✅ [步驟 2] - 完成
3. ✅ [步驟 3] - 完成

**驗證結果**:
\`\`\`bash
npm test -- [模組]
# 輸出: ✅ 3 tests passed
\`\`\`

**狀態**: ✅ 完成
```

---

### Step 3: 報告進度

每完成一個批次後，提供進度報告：

```markdown
## 📊 批次 N 完成報告

### 已完成任務
1. ✅ [任務 1] - [簡述成果]
2. ✅ [任務 2] - [簡述成果]
3. ✅ [任務 3] - [簡述成果]

### 驗證結果
| 任務 | 測試 | 狀態 |
|------|------|------|
| 任務 1 | 3/3 passed | ✅ |
| 任務 2 | 5/5 passed | ✅ |
| 任務 3 | 2/2 passed | ✅ |

### 發現的問題
- [問題 1]（如有）

### 剩餘任務
- [ ] 任務 4
- [ ] 任務 5
- [ ] ...

---
**等待反饋**：請審查上述成果，確認後繼續下一批次。
```

---

### Step 4: 整合反饋

```markdown
收到反饋後：

1. **記錄反饋**
   - 直接將反饋加入任務清單
   - 調整後續任務優先順序

2. **調整方向**
   - 如果需要重大變更，更新計畫
   - 如果是小調整，直接整合

3. **繼續執行**
   - 開始下一批次
   - 重複 Step 2-4
```

---

### Step 5: 完成開發

所有任務完成後：

```markdown
## 🎉 計畫執行完成

### 總結
- 總任務數: [N]
- 完成批次: [M]
- 總測試: [X] passed

### 最終驗證
\`\`\`bash
npm test
# 輸出: ✅ All tests passed

npm run build
# 輸出: ✅ Build successful
\`\`\`

---

**下一步**: 使用 git-workflow 技能完成分支
```

---

## 四、關鍵停止點

### 必須立即停止的情況

```markdown
🔴 遇到以下情況時，立即停止並請求澄清：

1. **阻塞問題**
   - 依賴項不可用
   - 環境配置問題

2. **測試持續失敗**
   - 多次嘗試仍失敗
   - 不明原因的錯誤

3. **指令不清楚**
   - 計畫步驟模糊
   - 多種可能解釋

4. **範圍蔓延**
   - 發現需要額外工作
   - 任務比預期複雜
```

**停止報告模板**:
```markdown
## ⚠️ 執行暫停

### 問題
[描述遇到的問題]

### 已嘗試
1. [嘗試 1]
2. [嘗試 2]

### 需要澄清
[具體問題]

### 建議選項
A. [選項 A]
B. [選項 B]

請選擇或提供其他指導。
```

---

## 五、批次配置

### 5.1 批次大小建議

| 任務複雜度 | 建議批次大小 | 說明 |
|-----------|-------------|------|
| 簡單任務 | 5 個/批次 | 驗證快，可批量處理 |
| 標準任務 | 3 個/批次 | 預設配置 |
| 複雜任務 | 1-2 個/批次 | 需要更頻繁確認 |
| 高風險任務 | 1 個/批次 | 每個任務單獨審查 |

### 5.2 調整批次大小

```markdown
用戶可以要求調整：

- "每批執行 5 個任務"
- "一個一個執行"
- "加快進度，批次大一點"
```

---

## 六、與其他技能的配合

### 6.1 前置技能

```
writing-plans → executing-plans
     ↓              ↓
  生成計畫      執行計畫
```

### 6.2 後置技能

```
executing-plans → git-workflow
      ↓              ↓
  執行完成      完成分支
```

### 6.3 並行技能

```
executing-plans + dispatching-parallel-agents
      ↓                    ↓
  批次執行          並行處理獨立任務
```

---

## 七、禁止行為

```markdown
❌ 絕對禁止：

1. 跳過驗證步驟
2. 不等反饋就繼續下一批次
3. 偏離計畫"改進"實作
4. 忽略失敗的測試
5. 在阻塞時自行假設
6. 合併多個批次不報告
7. 修改計畫不通知用戶
```

---

## 八、自檢清單

### 開始執行前

```markdown
□ 完整閱讀計畫
□ 識別潛在問題
□ 確認環境準備就緒
□ 確認用戶準備好審查
```

### 每個批次完成後

```markdown
□ 所有任務驗證通過
□ 進度報告已發送
□ 等待用戶反饋
□ 整合反饋後才繼續
```

### 整體完成後

```markdown
□ 所有任務完成
□ 所有測試通過
□ 最終驗證執行
□ 使用 git-workflow 完成
```

---

## 參考資源

- [obra/superpowers - executing-plans](https://github.com/obra/superpowers)
- **相關技能**:
  - `writing-plans` - 生成執行計畫
  - `git-workflow` - 完成開發分支
  - `dispatching-parallel-agents` - 並行任務處理

---

**版本**: 1.0.0
**最後更新**: 2025-12-26
